{"version":3,"sources":["../src/Collapse.js"],"names":[],"mappings":";;;;;;;;AAAA;;;;AACA;;AACA;;AACA;;;;;;;;AAGA,IAAM,eAAe,SAAf,YAAe;SAAU,KAAK,GAAL,CAAS,CAAT,EAAY,WAAW,MAAX,CAAZ,EAAgC,OAAhC,CAAwC,CAAxC;CAAV;;AAGrB,IAAM,WAAW,gBAAM,WAAN,CAAkB;;;AACjC,aAAW;AACT,cAAU,gBAAM,SAAN,CAAgB,IAAhB,CAAqB,UAArB;AACV,cAAU,gBAAM,SAAN,CAAgB,IAAhB,CAAqB,UAArB;AACV,iBAAa,gBAAM,SAAN,CAAgB,MAAhB;AACb,WAAO,gBAAM,SAAN,CAAgB,MAAhB;AACP,kBAAc,gBAAM,SAAN,CAAgB,QAAhB,CAAyB,gBAAM,SAAN,CAAgB,MAAhB,CAAvC;AACA,0BAAsB,gBAAM,SAAN,CAAgB,IAAhB;AACtB,mBAAe,gBAAM,SAAN,CAAgB,IAAhB;GAPjB;;AAWA,8CAAkB;AAChB,WAAO,EAAC,aAAa,CAAC,CAAD,EAAI,OAAO,EAAP,EAAW,sBAAsB,KAAtB,EAApC,CADgB;GAZe;AAiBjC,8CAAkB;AAChB,WAAO,EAAC,QAAQ,CAAC,CAAD,EAAI,iBAAiB,KAAjB,EAApB,CADgB;GAjBe;AAqBjC,oDAAqB;AACnB,SAAK,MAAL,GAAc,aAAa,CAAb,CAAd,CADmB;AAEnB,SAAK,YAAL,GAAoB,IAApB,CAFmB;GArBY;AA2BjC,sEAAsC;;;QAAX,yBAAW;;AACpC,QAAI,kBAAkB,aAAa,KAAK,KAAL,CAAW,QAAX,CADC;AAEpC,SAAK,QAAL,CAAc,EAAC,gCAAD,EAAd,EAAiC,YAAM;AACrC,UAAI,MAAK,KAAL,CAAW,aAAX,IAA4B,eAA5B,EAA6C;AAC/C,cAAK,KAAL,CAAW,aAAX,CAAyB,WAAW,MAAK,KAAL,CAAW,MAAX,GAAoB,CAA/B,CAAzB,CAD+C;OAAjD;KAD+B,CAAjC,CAFoC;GA3BL;;;AAqCjC,iFArCiC;;AAwCjC,wCAAc,QAAQ;AACpB,QAAI,KAAK,YAAL,IAAqB,KAAK,KAAL,CAAW,QAAX,EAAqB;AAC5C,WAAK,MAAL,GAAc,aAAa,MAAb,CAAd,CAD4C;KAA9C;AAGA,SAAK,QAAL,CAAc,EAAC,cAAD,EAAd,EAJoB;AAKpB,QAAI,KAAK,KAAL,CAAW,aAAX,IAA4B,CAAC,KAAK,KAAL,CAAW,eAAX,EAA4B;AAC3D,WAAK,KAAL,CAAW,aAAX,CAAyB,KAAK,KAAL,CAAW,QAAX,GAAsB,MAAtB,GAA+B,CAA/B,CAAzB,CAD2D;KAA7D;GA7C+B;AAmDjC,4CAAgB,QAAQ;iBACW,KAAK,KAAL,CADX;QACf,2BADe;QACL,mCADK;QAEf,kBAAmB,KAAK,KAAL,CAAnB,gBAFe;;;AAItB,QAAM,YAAY,WAAW,KAAK,GAAL,CAAS,CAAT,EAAY,WAAW,MAAX,CAAZ,EAAgC,OAAhC,CAAwC,CAAxC,CAAX,GAAwD,aAAa,CAAb,CAAxD;;;;AAJI,QAQhB,gBAAgB,CAAC,eAAD,IAAoB,CAAC,QAAD,IAAa,KAAK,MAAL,KAAgB,SAAhB,CARjC;;AAUtB,QAAM,eAAe,yBAAO,WAAW,KAAK,GAAL,CAAS,CAAT,EAAY,MAAZ,CAAX,GAAiC,CAAjC,EAAoC,YAA3C,CAAf,CAVgB;AAWtB,QAAM,gBAAgB,WAAW,KAAK,GAAL,CAAS,CAAT,EAAY,MAAZ,CAAX,GAAiC,CAAjC,CAXA;;AAatB,WAAO,gBAAgB,aAAhB,GAAgC,YAAhC,CAbe;GAnDS;AAoEjC,sCAAc;;;kBAGR,KAAK,KAAL,CAHQ;QAEV,4BAFU;QAEA,sBAFA;QAEO,4BAFP;QAEiB,kCAFjB;QAE4C,YAAd,aAF9B;QAE+C,oDAF/C;;QAEwE,oIAFxE;;AAKZ,QAAI,KAAK,YAAL,EAAmB;AACrB,WAAK,YAAL,GAAoB,KAApB,CADqB;AAErB,UAAM,WAAW,EAAC,UAAU,QAAV,EAAoB,QAAQ,WAAW,WAAX,GAAyB,CAAzB,EAAxC,CAFe;;AAIrB,UAAI,CAAC,oBAAD,IAAyB,CAAC,QAAD,EAAW;AACtC,eAAO,IAAP,CADsC;OAAxC;AAGA,WAAK,MAAL,GAAc,aAAa,WAAb,CAAd,CAPqB;AAQrB,aAAO;;mBAAK,oBAAW,UAAa,MAAxB,IAAoC,MAAzC;QAAiD,QAAjD;OAAP,CARqB;KAAvB;;AAWA,WACE;;;AACE,sBAAc,EAAC,QAAQ,WAAW,CAAX,GAAe,WAAf,EAAvB;AACA,eAAO,EAAC,QAAQ,KAAK,eAAL,CAAqB,WAArB,CAAR,EAAR,EAFF;MAGG,iBAAc;YAAZ,sBAAY;;AACb,eAAK,MAAL,GAAc,aAAa,MAAb,CAAd;;;;AADa,YAKT,CAAC,oBAAD,IAAyB,CAAC,QAAD,IAAa,OAAK,MAAL,KAAgB,aAAa,CAAb,CAAhB,EAAiC;AACzE,iBAAO,IAAP,CADyE;SAA3E;;AAIA,YAAM,WAAW,EAAC,UAAU,QAAV,EAAoB,cAArB,EAAX,CATO;;AAWb,eAAO;;qBAAK,oBAAW,UAAa,MAAxB,IAAoC,MAAzC;UAAiD,QAAjD;SAAP,CAXa;OAAd;KAJL,CAhBY;GApEmB;AA0GjC,4BAAS;;;kBAGH,KAAK,KAAL,CAHG;QAEL,4BAFK;QAEK,sBAFL;QAEY,4BAFZ;QAEsB,kCAFtB;QAEiD,YAAd,aAFnC;QAEoD,oDAFpD;;QAE6E,oIAF7E;;AAKP,QAAI,cAAc,CAAC,CAAD,EAAI;AACpB,aAAO,KAAK,WAAL,EAAP,CADoB;KAAtB;;AAIA,QAAM,eAAe,KAAK,YAAL,CATd;QAUA,SAAU,KAAK,KAAL,CAAV,OAVA;;AAWP,QAAM,sBAAsB,WAAW,MAAX,EAAmB,OAAnB,CAA2B,CAA3B,CAAtB,CAXC;;AAaP,QAAI,SAAS,CAAC,CAAD,IAAM,YAAf,EAA6B;AAC/B,WAAK,YAAL,GAAoB,KAApB,CAD+B;KAAjC;;;AAbO,QAkBD,UAAU;;QAAgB,eAAe,KAAK,aAAL,EAA/B;MAAoD,QAApD;KAAV,CAlBC;;AAoBP,QAAI,YAAJ,EAAkB;AAChB,UAAM,WAAW,EAAC,UAAU,QAAV,EAAoB,QAAQ,WAAW,MAAX,GAAoB,CAApB,EAAxC,CADU;;AAGhB,UAAI,CAAC,QAAD,IAAa,SAAS,CAAC,CAAD,EAAI;AAC5B,YAAI,CAAC,oBAAD,EAAuB;AACzB,iBAAO,IAAP,CADyB;SAA3B;AAGA,eACE;;qBAAK,kBAAQ,QAAQ,CAAR,EAAW,UAAU,QAAV,IAAuB,MAA1C,IAAsD,MAA3D;UACG,OADH;SADF,CAJ4B;OAA9B;;AAWA,aAAO;;mBAAK,oBAAW,UAAa,MAAxB,IAAoC,MAAzC;QAAiD,OAAjD;OAAP,CAdgB;KAAlB;;AAiBA,WACE;;;AACE,sBAAc,EAAC,QAAQ,WAAW,CAAX,GAAe,KAAK,GAAL,CAAS,CAAT,EAAY,MAAZ,CAAf,EAAvB;AACA,eAAO,EAAC,QAAQ,KAAK,eAAL,CAAqB,MAArB,CAAR,EAAR,EAFF;MAGG,cAAM;AACL,eAAK,MAAL,GAAc,aAAa,GAAG,MAAH,CAA3B;;;;AADK,YAKD,CAAC,QAAD,IAAa,OAAK,MAAL,KAAgB,KAAhB,EAAuB;AACtC,cAAI,CAAC,oBAAD,EAAuB;AACzB,mBAAO,IAAP,CADyB;WAA3B;AAGA,iBACE;;uBAAK,kBAAQ,QAAQ,CAAR,EAAW,UAAU,QAAV,IAAuB,MAA1C,IAAsD,MAA3D;YACG,OADH;WADF,CAJsC;SAAxC;;AAWA,YAAM,WAAW,YAAY,OAAK,MAAL,KAAgB,mBAAhB,GAAsC,EAAC,QAAQ,MAAR,EAAnD,GAAqE;AACpF,kBAAQ,GAAG,MAAH,EAAW,UAAU,QAAV;SADJ,CAhBZ;;AAoBL,eAAO;;qBAAK,oBAAW,UAAa,MAAxB,IAAoC,MAAzC;UAAiD,OAAjD;SAAP,CApBK;OAAN;KAJL,CArCO;GA1GwB;CAAlB,CAAX;;kBA+KS","file":"Collapse.js","sourcesContent":["import React from 'react';\r\nimport {shouldComponentUpdate} from 'react/lib/ReactComponentWithPureRenderMixin';\r\nimport {Motion, spring} from 'react-motion';\r\nimport HeightReporter from 'react-height';\r\n\r\n\r\nconst stringHeight = height => Math.max(0, parseFloat(height)).toFixed(1);\r\n\r\n\r\nconst Collapse = React.createClass({\r\n  propTypes: {\r\n    isOpened: React.PropTypes.bool.isRequired,\r\n    children: React.PropTypes.node.isRequired,\r\n    fixedHeight: React.PropTypes.number,\r\n    style: React.PropTypes.object, // eslint-disable-line react/forbid-prop-types\r\n    springConfig: React.PropTypes.objectOf(React.PropTypes.number),\r\n    keepCollapsedContent: React.PropTypes.bool,\r\n    onHeightReady: React.PropTypes.func\r\n  },\r\n\r\n\r\n  getDefaultProps() {\r\n    return {fixedHeight: -1, style: {}, keepCollapsedContent: false};\r\n  },\r\n\r\n\r\n  getInitialState() {\r\n    return {height: -1, isOpenedChanged: false};\r\n  },\r\n\r\n  componentWillMount() {\r\n    this.height = stringHeight(0);\r\n    this.renderStatic = true;\r\n  },\r\n\r\n\r\n  componentWillReceiveProps({isOpened}) {\r\n    var isOpenedChanged = isOpened !== this.props.isOpened;\r\n    this.setState({isOpenedChanged}, () => {\r\n      if (this.props.onHeightReady && isOpenedChanged) {\r\n        this.props.onHeightReady(isOpened ? this.state.height : 0);\r\n      }\r\n    });\r\n  },\r\n\r\n\r\n  shouldComponentUpdate,\r\n\r\n\r\n  onHeightReady(height) {\r\n    if (this.renderStatic && this.props.isOpened) {\r\n      this.height = stringHeight(height);\r\n    }\r\n    this.setState({height});\r\n    if (this.props.onHeightReady && !this.state.isOpenedChanged) {\r\n      this.props.onHeightReady(this.props.isOpened ? height : 0);\r\n    }\r\n  },\r\n\r\n\r\n  getMotionHeight(height) {\r\n    const {isOpened, springConfig} = this.props;\r\n    const {isOpenedChanged} = this.state;\r\n\r\n    const newHeight = isOpened ? Math.max(0, parseFloat(height)).toFixed(1) : stringHeight(0);\r\n\r\n    // No need to animate if content is closed and it was closed previously\r\n    // Also no need to animate if height did not change\r\n    const skipAnimation = !isOpenedChanged && !isOpened || this.height === newHeight;\r\n\r\n    const springHeight = spring(isOpened ? Math.max(0, height) : 0, springConfig);\r\n    const instantHeight = isOpened ? Math.max(0, height) : 0;\r\n\r\n    return skipAnimation ? instantHeight : springHeight;\r\n  },\r\n\r\n\r\n  renderFixed() {\r\n    const {\r\n      isOpened, style, children, fixedHeight, springConfig: _, keepCollapsedContent, ...props\r\n    } = this.props;\r\n\r\n    if (this.renderStatic) {\r\n      this.renderStatic = false;\r\n      const newStyle = {overflow: 'hidden', height: isOpened ? fixedHeight : 0};\r\n\r\n      if (!keepCollapsedContent && !isOpened) {\r\n        return null;\r\n      }\r\n      this.height = stringHeight(fixedHeight);\r\n      return <div style={{...newStyle, ...style}} {...props}>{children}</div>;\r\n    }\r\n\r\n    return (\r\n      <Motion\r\n        defaultStyle={{height: isOpened ? 0 : fixedHeight}}\r\n        style={{height: this.getMotionHeight(fixedHeight)}}>\r\n        {({height}) => {\r\n          this.height = stringHeight(height);\r\n\r\n          // TODO: this should be done using onEnd from ReactMotion, which is not yet implemented\r\n          // See https://github.com/chenglou/react-motion/issues/235\r\n          if (!keepCollapsedContent && !isOpened && this.height === stringHeight(0)) {\r\n            return null;\r\n          }\r\n\r\n          const newStyle = {overflow: 'hidden', height};\r\n\r\n          return <div style={{...newStyle, ...style}} {...props}>{children}</div>;\r\n        }}\r\n      </Motion>\r\n    );\r\n  },\r\n\r\n\r\n  render() {\r\n    const {\r\n      isOpened, style, children, fixedHeight, springConfig: _, keepCollapsedContent, ...props\r\n    } = this.props;\r\n\r\n    if (fixedHeight > -1) {\r\n      return this.renderFixed();\r\n    }\r\n\r\n    const renderStatic = this.renderStatic;\r\n    const {height} = this.state;\r\n    const currentStringHeight = parseFloat(height).toFixed(1);\r\n\r\n    if (height > -1 && renderStatic) {\r\n      this.renderStatic = false;\r\n    }\r\n\r\n    // Cache Content so it is not re-rendered on each animation step\r\n    const content = <HeightReporter onHeightReady={this.onHeightReady}>{children}</HeightReporter>;\r\n\r\n    if (renderStatic) {\r\n      const newStyle = {overflow: 'hidden', height: isOpened ? 'auto' : 0};\r\n\r\n      if (!isOpened && height > -1) {\r\n        if (!keepCollapsedContent) {\r\n          return null;\r\n        }\r\n        return (\r\n          <div style={{height: 0, overflow: 'hidden', ...style}} {...props}>\r\n            {content}\r\n          </div>\r\n        );\r\n      }\r\n\r\n      return <div style={{...newStyle, ...style}} {...props}>{content}</div>;\r\n    }\r\n\r\n    return (\r\n      <Motion\r\n        defaultStyle={{height: isOpened ? 0 : Math.max(0, height)}}\r\n        style={{height: this.getMotionHeight(height)}}>\r\n        {st => {\r\n          this.height = stringHeight(st.height);\r\n\r\n          // TODO: this should be done using onEnd from ReactMotion, which is not yet implemented\r\n          // See https://github.com/chenglou/react-motion/issues/235\r\n          if (!isOpened && this.height === '0.0') {\r\n            if (!keepCollapsedContent) {\r\n              return null;\r\n            }\r\n            return (\r\n              <div style={{height: 0, overflow: 'hidden', ...style}} {...props}>\r\n                {content}\r\n              </div>\r\n            );\r\n          }\r\n\r\n          const newStyle = isOpened && this.height === currentStringHeight ? {height: 'auto'} : {\r\n            height: st.height, overflow: 'hidden'\r\n          };\r\n\r\n          return <div style={{...newStyle, ...style}} {...props}>{content}</div>;\r\n        }}\r\n      </Motion>\r\n    );\r\n  }\r\n});\r\n\r\n\r\nexport default Collapse;\r\n"]}