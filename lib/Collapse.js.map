{"version":3,"sources":["../src/Collapse.js"],"names":[],"mappings":"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","file":"Collapse.js","sourcesContent":["import React from 'react';\nimport {shouldComponentUpdate} from 'react/lib/ReactComponentWithPureRenderMixin';\nimport {Motion, spring} from 'react-motion';\nimport HeightReporter from 'react-height';\n\n\nconst stringHeight = height => Math.max(0, parseFloat(height)).toFixed(1);\n\n\nconst Collapse = React.createClass({\n  propTypes: {\n    isOpened: React.PropTypes.bool.isRequired,\n    children: React.PropTypes.node.isRequired,\n    fixedHeight: React.PropTypes.number,\n    style: React.PropTypes.object, // eslint-disable-line react/forbid-prop-types\n    springConfig: React.PropTypes.objectOf(React.PropTypes.number),\n    keepCollapsedContent: React.PropTypes.bool,\n    onHeightReady: React.PropTypes.func\n  },\n\n\n  getDefaultProps() {\n    return {\n      fixedHeight: -1,\n      style: {},\n      keepCollapsedContent: false,\n      onHeightReady: () => {} // eslint-disable-line no-empty-function\n    };\n  },\n\n\n  getInitialState() {\n    return {height: -1, isOpenedChanged: false};\n  },\n\n  componentWillMount() {\n    this.height = stringHeight(0);\n    this.renderStatic = true;\n  },\n\n\n  componentWillReceiveProps({isOpened}) {\n    this.setState({isOpenedChanged: isOpened !== this.props.isOpened});\n  },\n\n  shouldComponentUpdate,\n\n  componentDidUpdate({isOpened}) {\n    if (isOpened !== this.props.isOpened) {\n      const report = this.props.isOpened ? this.state.height : 0;\n\n      this.props.onHeightReady(report);\n    }\n  },\n\n  onHeightReady(height) {\n    if (this.renderStatic && this.props.isOpened) {\n      this.height = stringHeight(height);\n    }\n    this.setState({height});\n\n    const reportHeight = this.props.isOpened ? height : 0;\n\n    if (this.state.height !== reportHeight) {\n      this.props.onHeightReady(reportHeight);\n    }\n  },\n\n\n  getMotionHeight(height) {\n    const {isOpened, springConfig} = this.props;\n    const {isOpenedChanged} = this.state;\n\n    const newHeight = isOpened ? Math.max(0, parseFloat(height)).toFixed(1) : stringHeight(0);\n\n    // No need to animate if content is closed and it was closed previously\n    // Also no need to animate if height did not change\n    const skipAnimation = !isOpenedChanged && !isOpened || this.height === newHeight;\n\n    const springHeight = spring(isOpened ? Math.max(0, height) : 0, springConfig);\n    const instantHeight = isOpened ? Math.max(0, height) : 0;\n\n    return skipAnimation ? instantHeight : springHeight;\n  },\n\n\n  renderFixed() {\n    const {\n      isOpened, style, children, fixedHeight, springConfig: _, keepCollapsedContent, ...props\n    } = this.props;\n\n    if (this.renderStatic) {\n      this.renderStatic = false;\n      const newStyle = {overflow: 'hidden', height: isOpened ? fixedHeight : 0};\n\n      if (!keepCollapsedContent && !isOpened) {\n        return null;\n      }\n      this.height = stringHeight(fixedHeight);\n      return <div style={{...newStyle, ...style}} {...props}>{children}</div>;\n    }\n\n    return (\n      <Motion\n        defaultStyle={{height: isOpened ? 0 : fixedHeight}}\n        style={{height: this.getMotionHeight(fixedHeight)}}>\n        {({height}) => {\n          this.height = stringHeight(height);\n\n          // TODO: this should be done using onEnd from ReactMotion, which is not yet implemented\n          // See https://github.com/chenglou/react-motion/issues/235\n          if (!keepCollapsedContent && !isOpened && this.height === stringHeight(0)) {\n            return null;\n          }\n\n          const newStyle = {overflow: 'hidden', height};\n\n          return <div style={{...newStyle, ...style}} {...props}>{children}</div>;\n        }}\n      </Motion>\n    );\n  },\n\n\n  render() {\n    const {\n      isOpened, style, children, fixedHeight, springConfig: _, keepCollapsedContent, ...props\n    } = this.props;\n\n    if (fixedHeight > -1) {\n      return this.renderFixed();\n    }\n\n    const renderStatic = this.renderStatic;\n    const {height} = this.state;\n    const currentStringHeight = parseFloat(height).toFixed(1);\n\n    if (height > -1 && renderStatic) {\n      this.renderStatic = false;\n    }\n\n    // Cache Content so it is not re-rendered on each animation step\n    const content = <HeightReporter onHeightReady={this.onHeightReady}>{children}</HeightReporter>;\n\n    if (renderStatic) {\n      const newStyle = {overflow: 'hidden', height: isOpened ? 'auto' : 0};\n\n      if (!isOpened && height > -1) {\n        if (!keepCollapsedContent) {\n          return null;\n        }\n        return (\n          <div style={{height: 0, overflow: 'hidden', ...style}} {...props}>\n            {content}\n          </div>\n        );\n      }\n\n      return <div style={{...newStyle, ...style}} {...props}>{content}</div>;\n    }\n\n    return (\n      <Motion\n        defaultStyle={{height: isOpened ? 0 : Math.max(0, height)}}\n        style={{height: this.getMotionHeight(height)}}>\n        {st => {\n          this.height = stringHeight(st.height);\n\n          // TODO: this should be done using onEnd from ReactMotion, which is not yet implemented\n          // See https://github.com/chenglou/react-motion/issues/235\n          if (!isOpened && this.height === '0.0') {\n            if (!keepCollapsedContent) {\n              return null;\n            }\n            return (\n              <div style={{height: 0, overflow: 'hidden', ...style}} {...props}>\n                {content}\n              </div>\n            );\n          }\n\n          const newStyle = isOpened && this.height === currentStringHeight ? {height: 'auto'} : {\n            height: st.height, overflow: 'hidden'\n          };\n\n          return <div style={{...newStyle, ...style}} {...props}>{content}</div>;\n        }}\n      </Motion>\n    );\n  }\n});\n\n\nexport default Collapse;\n"]}